<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RGXAR AI</title>
<style>
:root{--bg:#0a0a0a;--panel:#111;--text:#fff;--accent:#0ff;--sec:#333;--input-bg:#222;}
body.light{--bg:#f4f4f4;--panel:#fff;--text:#000;--accent:#00cccc;--sec:#ccc;--input-bg:#eee;}
body{margin:0;font-family:Segoe UI,Arial;background:var(--bg);color:var(--text);height:100vh;overflow:hidden;transition:.4s;}
#loginBox{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--panel);padding:30px;border-radius:16px;width:400px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.5);}
.login-section{margin-bottom:20px;padding:15px;border-radius:12px;background:var(--panel);}
.login-section h3{margin-bottom:10px;}
input,textarea{width:100%;padding:12px;margin:10px 0;border-radius:8px;border:1px solid var(--sec);background:var(--input-bg);color:var(--text);outline:none;}
textarea{resize:none;height:80px;}
.btn{padding:12px;border:none;border-radius:8px;background:var(--accent);font-weight:bold;margin-top:10px;width:100%;cursor:pointer;transition:.2s;}
.btn:hover{opacity:.9;}
/* CHAT WRAPPER */
#chat{display:flex;height:100vh;overflow:hidden;}
/* CHAT ALANI */
#mainChat{flex:1;display:flex;flex-direction:column;transition:margin-right .3s ease;}
#messages{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:12px;}
.msg{max-width:75%;padding:14px;border-radius:12px;opacity:0;transform:translateY(15px);animation:fade .2s forwards;}
.user{align-self:flex-end;background:var(--accent);color:#000;}
.ai{align-self:flex-start;background:var(--panel);border:1px solid var(--accent);}
@keyframes fade{to{opacity:1;transform:none;}}
#send{display:flex;gap:10px;padding:14px;border-top:1px solid var(--sec);background:var(--panel);}
#send textarea{flex:1;font-size:18px;padding:16px;border-radius:10px;border:1px solid var(--sec);background:var(--input-bg);color:var(--text);}
#send button{padding:16px 26px;border:none;border-radius:10px;background:var(--accent);font-weight:700;cursor:pointer;}
/* SETTINGS */
#settingsBtn{position:fixed;right:20px;top:20px;z-index:50;width:50px;height:50px;border:none;background:#0ff;border-radius:50%;cursor:pointer;font-size:24px;font-weight:bold;color:#000;}
#settings{position:fixed;top:0;right:-320px;width:320px;height:100%;background:var(--panel);border-left:1px solid var(--sec);padding:20px;transition:.3s;z-index:40;overflow-y:auto;}
#settings.open{right:0;}
body.settings-open #mainChat{margin-right:320px;}
#settings h3{margin:0 0 10px;}
#settings label{display:block;margin-top:12px;}
#settings select,#settings input{width:100%;padding:10px;border-radius:8px;border:1px solid var(--sec);background:var(--input-bg);color:var(--text);}
#settings button{width:100%;margin-top:12px;padding:10px;border:none;border-radius:8px;background:var(--accent);cursor:pointer;}
</style>
</head>
<body>

<div id="loginBox">
  <div class="login-section">
    <h3>KayÄ±t Ol</h3>
    <input id="regEmail" placeholder="E-mail">
    <input id="regPass" type="password" placeholder="Åžifre (min 6)">
    <input id="regCaptcha" placeholder="Captcha: SayÄ± doÄŸrula">
    <div id="regCaptchaText" style="margin:5px 0;font-weight:bold;"></div>
    <button class="btn" id="registerBtn">KayÄ±t Ol</button>
  </div>
  <div class="login-section">
    <h3>GiriÅŸ Yap</h3>
    <input id="loginEmail" placeholder="E-mail">
    <input id="loginPass" type="password" placeholder="Åžifre">
    <input id="loginCaptcha" placeholder="Captcha: SayÄ± doÄŸrula">
    <div id="loginCaptchaText" style="margin:5px 0;font-weight:bold;"></div>
    <button class="btn" id="loginBtn">GiriÅŸ Yap</button>
  </div>
</div>

<div id="chat">
  <button id="settingsBtn">âš™</button>
  <div id="settings">
    <h3>Ayarlar</h3>
    <label>Tema</label>
    <select id="themeSel"><option value="dark">Dark</option><option value="light">Light</option></select>
    <label>FPS</label>
    <select id="fpsSel"><option>30</option><option>60</option><option>90</option><option>120</option><option>144</option><option>240</option></select>
    <label>MÃ¼zik URL</label>
    <input id="musicUrl" placeholder="https://site.com/music.mp3">
    <button id="playMusic">Ã‡al / Durdur</button>
    <label><input type="checkbox" id="smoothToggle" checked> AkÄ±cÄ±lÄ±k</label>
  </div>
  <div id="mainChat">
    <div id="messages"></div>
    <div id="send">
      <textarea id="msg" placeholder="Cheat / mesaj yaz (geniÅŸ, paragraf yazabilir)"></textarea>
      <button id="sendBtn">GÃ¶nder</button>
    </div>
  </div>
</div>

<audio id="player"></audio>

<script>
const regEmail=document.getElementById("regEmail");
const regPass=document.getElementById("regPass");
const regCaptcha=document.getElementById("regCaptcha");
const regCaptchaText=document.getElementById("regCaptchaText");
const loginEmail=document.getElementById("loginEmail");
const loginPass=document.getElementById("loginPass");
const loginCaptcha=document.getElementById("loginCaptcha");
const loginCaptchaText=document.getElementById("loginCaptchaText");
const loginBox=document.getElementById("loginBox");
const chat=document.getElementById("chat");
const messages=document.getElementById("messages");
const msg=document.getElementById("msg");
const registerBtn=document.getElementById("registerBtn");
const loginBtn=document.getElementById("loginBtn");
const settings=document.getElementById("settings");
const settingsBtn=document.getElementById("settingsBtn");
const themeSel=document.getElementById("themeSel");
const fpsSel=document.getElementById("fpsSel");
const smoothToggle=document.getElementById("smoothToggle");
const player=document.getElementById("player");
const musicUrl=document.getElementById("musicUrl");
const playMusic=document.getElementById("playMusic");

/* CAPTCHA */
let regRandom=Math.floor(Math.random()*9000+1000);
let loginRandom=Math.floor(Math.random()*9000+1000);
regCaptchaText.innerText="DoÄŸrula: "+regRandom;
loginCaptchaText.innerText="DoÄŸrula: "+loginRandom;

/* ADD MESSAGE */
function addMsg(t,r){
  const d=document.createElement("div");
  d.className="msg "+r;
  d.innerText=t;
  messages.appendChild(d);
  if(smoothToggle.checked){ d.style.animation="none"; void d.offsetWidth; d.style.animation=null; }
  messages.scrollTop=messages.scrollHeight;
}

/* AUTO LOGIN SAME IP */
if(localStorage.userData){
  const data=JSON.parse(localStorage.userData);
  loginBox.style.display="none";
  chat.style.display="flex";
  addMsg("RGXAR AI'ye HoÅŸgeldin ðŸ˜˜","ai");
}

/* REGISTER */
registerBtn.onclick=()=>{
  if(regPass.value.length<6) return alert("Åžifre en az 6 karakter");
  if(Number(regCaptcha.value)!==regRandom) return alert("Captcha hatalÄ±");
  localStorage.userData=JSON.stringify({email:regEmail.value,pass:regPass.value});
  loginBox.style.display="none";
  chat.style.display="flex";
  addMsg("RGXAR AI'ye HoÅŸgeldin ðŸ˜˜","ai");
};

/* LOGIN */
loginBtn.onclick=()=>{
  if(!localStorage.userData) return alert("Ã–nce kayÄ±t olun");
  const data=JSON.parse(localStorage.userData);
  if(loginEmail.value!==data.email||loginPass.value!==data.pass) return alert("HatalÄ± giriÅŸ");
  if(Number(loginCaptcha.value)!==loginRandom) return alert("Captcha hatalÄ±");
  loginBox.style.display="none";
  chat.style.display="flex";
  addMsg("RGXAR AI'ye HoÅŸgeldin ðŸ˜˜","ai");
};

/* CHAT API */
const API_KEY="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";

document.getElementById("sendBtn").onclick = async () => {
  if(!msg.value) return;
  addMsg(msg.value,"user");

  // placeholder AI mesajÄ±
  const aiPlaceholder = document.createElement("div");
  aiPlaceholder.className = "msg ai";
  aiPlaceholder.innerText = "YanÄ±t bekleniyor...";
  messages.appendChild(aiPlaceholder);
  messages.scrollTop = messages.scrollHeight;

  const convo = [{role:"system",content:"KÄ±sa, net ve sonuÃ§ odaklÄ±."},{role:"user",content:msg.value}];
  msg.value = "";

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{"Content-Type":"application/json","Authorization":"Bearer "+API_KEY},
      body:JSON.stringify({model:"gpt-4o-mini",messages:convo})
    });
    const data = await res.json();
    aiPlaceholder.innerText = data.choices[0].message.content;
  } catch {
    aiPlaceholder.innerText = "API HatasÄ±";
  }
};

/* SETTINGS */
settingsBtn.onclick=()=>{
  settings.classList.toggle("open");
  document.body.classList.toggle("settings-open");
};
themeSel.onchange=e=>document.body.classList.toggle("light",e.target.value==="light");
let fps=60,last=0;
fpsSel.onchange=e=>fps=+e.target.value;
function loop(t){if(t-last>1000/fps){last=t;} requestAnimationFrame(loop);}
requestAnimationFrame(loop);
playMusic.onclick=()=>{if(player.paused){if(musicUrl.value)player.src=musicUrl.value;player.play();} else player.pause();};
</script>
</body>
</html>
